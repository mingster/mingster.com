import { mingster } from "@/app/blog/authors";

export const meta = {
  title: "ssh via apache deamon user",
  description: "Scenario: You have a web script (php, ruby, python, or so) that need to ssh over a remote machine to do stuff. How you do set up ssh key for the apache deamon...",
  date: "2009-11-12T00:00:00.000Z",
  authors: [mingster],
};

<p>Scenario: You have a web script (php, ruby, python, or so) that need to ssh over a remote machine to do stuff.  How you do set up ssh key for the apache deamon user?</p>
<p>After some dig out, here's the steps, mostly taken from (<a href="http://www.boredworkers.com/2009/08/24/script-tips-ssh-key-for-apache/">Boredworkers.com</a>):</p>
<p><span style="font-weight:bold;">Make key for apache daemon</span><br />1. log in to source server as root<br />2. create .ssh directory for apache user. Make sure you have the ownership right:<br /><code><br />$ mkdir /var/www/.ssh<br />$ chown -R apache:nobody /var/www/.ssh<br /></code></p>
<p>3. Generate the ssh-key authentication key as user apache using sudo. Use the default file location and leave empty when prompted for passphrase.<br /><code><br />$ sudo -u apache ssh-keygen -t rsa<br /></code></p>
<p>4. Append apache's public key to destination server<br /><code><br />$ sudo -u apache cat .ssh/id_rsa.pub | ssh dest_user@dest_server 'cat &gt;&gt; /var/www/.ssh/authorized_keys'<br /></code></p>
<p>5. Test the set up. Youâ€™ll see that you can now run ssh commands without being prompted for the user password:<br /><code><br />$ sudo -u apache ssh dest_user@dest_server<br /></code></p>
<p>refernce: <a href="http://www.boredworkers.com/2009/08/24/script-tips-ssh-key-for-apache/">http://www.boredworkers.com/2009/08/24/script-tips-ssh-key-for-apache/</a></p>
